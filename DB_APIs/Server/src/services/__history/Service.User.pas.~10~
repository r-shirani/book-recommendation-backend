Unit Service.User;

Interface

Uses
    System.Generics.Collections,
    System.SysUtils,
    MVCFramework.ActiveRecord,
    Model.User;

Type
    IUserService = Interface
        ['{8A1E86C2-EC7F-470D-B9AE-1E87C6E5A621}']
        Function GetUserByID(Const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(Const AUser: TUser);
        Procedure UpdateUser(Const AUser: TUser);
    End;

    TUserService = Class(TInterfacedObject, IUserService)
    Public
        Function GetUserByID(Const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(Const AUser: TUser);
        Procedure UpdateUser(Const AUser: TUser);
    End;

Implementation

{ TUserService }

//______________________________________________________________________________
Function TUserService.GetUserByID(Const UserID: Int64): TUser;
Begin
    Try
        Result := TMVCActiveRecord.GetByPK<TUser>(UserID);
    Except
        Result := NIL;
    End;
End;
//______________________________________________________________________________
Function TUserService.GetAllUsers: TObjectList<TUser>;
Begin
    Try
        Result := TMVCActiveRecord.All<TUser>;
    Except
        Result := NIL;
    End;
End;
//______________________________________________________________________________
Procedure TUserService.AddUser(Const AUser: TUser);
Begin
    AUser.Insert;
End;
//______________________________________________________________________________
Procedure TUserService.UpdateUser(Const AUser: TUser);
Begin
    AUser.Update;
End;
//______________________________________________________________________________

End.

