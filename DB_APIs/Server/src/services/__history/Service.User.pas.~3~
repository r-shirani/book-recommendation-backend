Unit Service.User;

Interface

Uses
    System.Generics.Collections,
    System.SysUtils,
    MVCFramework.ActiveRecord,
    Model.User;

Type
    IUserService = interface
        ['{8A1E86C2-EC7F-470D-B9AE-1E87C6E5A621}']
        Function GetUserByID(const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(const AUser: TUser);
        Procedure UpdateUser(const AUser: TUser);
        Procedure DeleteUser(const UserID: Int64);
    End;

    TUserService = class(TInterfacedObject, IUserService)
    public
        Function GetUserByID(const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(const AUser: TUser);
        Procedure UpdateUser(const AUser: TUser);
        Procedure DeleteUser(const UserID: Int64);
    End;

Implementation

{ TUserService }

//______________________________________________________________________________
Function TUserService.GetUserByID(const UserID: Int64): TUser;
Begin
    Result := TMVCActiveRecord.GetByPK<TUser>(UserID);
End;
//______________________________________________________________________________
Function TUserService.GetAllUsers: TObjectList<TUser>;
Begin
    Result := TMVCActiveRecord.All<TUser>;
End;
//______________________________________________________________________________
Procedure TUserService.AddUser(const AUser: TUser);
Begin
    AUser.Insert;
End;
//______________________________________________________________________________
Procedure TUserService.UpdateUser(const AUser: TUser);
Begin
    AUser.Update;
End;
//______________________________________________________________________________
Procedure TUserService.DeleteUser(const UserID: Int64);
var
    LUser: TUser;
Begin
    LUser := GetUserByID(UserID);
    try
        if Assigned(LUser) then
            LUser.Delete;
    finally
        LUser.Free;
    End;
End;
//______________________________________________________________________________

End.

