Unit Service.User;

Interface

Uses
    System.Generics.Collections,
    System.SysUtils,
    MVCFramework.ActiveRecord,
    Model.User;

Type
    IUserService = Interface
        ['{8A1E86C2-EC7F-470D-B9AE-1E87C6E5A621}']
        Function GetUserByID(Const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(Const AUser: TUser);
        Procedure UpdateUser(Const AUser: TUser);
        Procedure DeleteUser(Const UserID: Int64);
    End;

    TUserService = Class(TInterfacedObject, IUserService)
    public
        Function GetUserByID(Const UserID: Int64): TUser;
        Function GetAllUsers: TObjectList<TUser>;
        Procedure AddUser(Const AUser: TUser);
        Procedure UpdateUser(Const AUser: TUser);
        Procedure DeleteUser(Const UserID: Int64);
    End;

Implementation

{ TUserService }

//______________________________________________________________________________
Function TUserService.GetUserByID(Const UserID: Int64): TUser;
Begin
    Result := TMVCActiveRecord.GetByPK<TUser>(UserID);
End;
//______________________________________________________________________________
Function TUserService.GetAllUsers: TObjectList<TUser>;
Begin
    Result := TMVCActiveRecord.All<TUser>;
End;
//______________________________________________________________________________
Procedure TUserService.AddUser(Const AUser: TUser);
Begin
    AUser.Insert;
End;
//______________________________________________________________________________
Procedure TUserService.UpdateUser(Const AUser: TUser);
Begin
    AUser.Update;
End;
//______________________________________________________________________________
Procedure TUserService.DeleteUser(Const UserID: Int64);
Var
    LUser: TUser;
Begin
    LUser := GetUserByID(UserID);
    Try
        If Assigned(LUser) then
            LUser.Delete;
    Finally
        LUser.Free;
    End;
End;
//______________________________________________________________________________

End.

